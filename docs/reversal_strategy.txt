1. Introduction 
Purpose 

This report details quantitative algorithms and technical analysis methodologies designed to identify a specific stock market bottoming pattern. The objective is to provide actionable methods for detecting stocks that have undergone a prolonged downtrend, are exhibiting signs of reversal characterized by the behavior of the 150-day Simple Moving Average (SMA), and show initial price strength confirmation. 
User Requirements Recap 

The core criteria for the desired pattern, as specified by the user query, are: 

     

    A preceding downtrend lasting approximately one trading year. 
     

    The 150-day SMA flattening out after its decline. 
     

    The 150-day SMA subsequently beginning to turn upwards (positive slope). 
     

    The stock's closing price remaining consistently above the 150-day SMA for at least 5 consecutive trading days (one trading week). 
     

Methodology 

The analysis presented herein synthesizes information derived from established technical analysis principles, documentation of specific indicators, and descriptions of trading strategies, primarily referencing the provided research materials. The focus is on translating conceptual criteria into quantifiable, implementable steps suitable for algorithmic trading or systematic screening using daily Open, High, Low, Close (OHLC) data. 
Structure Overview 

This report is structured to address each component of the user's query systematically: 

     

    Quantifying the Preceding Downtrend: Defining and measuring a year-long decline. 
     

    Analyzing 150-Day SMA Dynamics: Methods for detecting the flattening and upward turn of the 150 SMA. 
     

    Confirming Price Strength: Verifying the price position relative to the 150 SMA over a specified duration. 
     

    Utilizing Confirmation Indicators: Incorporating secondary indicators (momentum, volume, patterns) to enhance signal reliability. 
     

    Integrated Algorithms and Strategies: Examining existing frameworks like Stage Analysis and MA Slope strategies that align with the criteria. 
     

    Implementation Considerations: Discussing practical aspects like MA type selection, parameter tuning, lag, whipsaws, and potential software tools. 
     

    Conclusion and Recommendations: Summarizing findings and suggesting actionable strategies. 
     

2. Quantifying the Preceding Downtrend (~1 Trading Year) 

Identifying a stock that is potentially bottoming requires establishing that it was previously in a significant downtrend. The user specifies this downtrend should span approximately one trading year. Defining and quantifying this condition programmatically is the first step. 
Defining "Downtrend" 

A downtrend signifies a period where selling pressure consistently overcomes buying pressure, leading to a decline in price over time. 

     

    Qualitative Definition: A downtrend is visually characterized on a price chart by a series of descending peaks (lower highs) and descending troughs (lower lows).1 This structure indicates that rallies fail to reach previous highs, and sell-offs push prices to new lows, reflecting a fundamental shift where the supply of shares offered for sale exceeds the demand at prevailing prices.1 
     

    Quantitative Definition 1 (Price vs. Long-Term MA): A common quantitative approach defines a downtrend by the stock's price consistently trading below a significant long-term moving average, such as the 200-day SMA.1 The 200-day SMA is widely recognized as a proxy for the long-term trend.6 Furthermore, a declining slope of this long-term moving average reinforces the downtrend signal.5 The sequence of lower lows and lower highs naturally pushes the price below its longer-term average, and as this average incorporates progressively lower prices, its own slope turns negative, thus quantitatively confirming the visual pattern.1 
     

    Quantitative Definition 2 (Performance): A downtrend can be simply quantified by measuring negative price performance over the specified lookback period. For a one-year timeframe, this involves calculating the percentage change between the current price and the price approximately 252 trading days prior. A significantly negative return (e.g., less than -20% or -30%) can serve as a downtrend filter.11 
     

    Quantitative Definition 3 (Stage Analysis): Stan Weinstein's Stage Analysis framework explicitly defines a downtrend as Stage 4 (Declining Phase). This stage is characterized by the stock price trading below a declining long-term moving average, originally specified as the 30-week (150-day) MA, but later often referenced using the 40-week (200-day) MA.12 This framework directly links the qualitative price structure (lower highs/lows) to the quantitative relationship with the long-term MA.12 
     

Defining "Trading Year" 

For the purpose of algorithmic implementation using daily data, one trading year is typically approximated as 252 trading days. This accounts for weekends and market holidays. 
Programmatic Implementation 

To implement a filter for a preceding one-year downtrend based on the daily OHLC data for the last ~252 trading days: 

     

    Calculate Long-Term MA: Compute the 200-day SMA. 
     

    Price vs. MA Check: Determine the percentage of days within the last 252 days where the closing price was below the 200-day SMA. A high percentage (e.g., > 75% or > 200 days) indicates a persistent downtrend relative to the long-term average. 
     

    MA Slope Check: Calculate the slope of the 200-day SMA over the past 252 days (methods detailed in Section 3.2). A consistently negative slope provides strong confirmation of the downtrend.5 
     

    Performance Check: Calculate the percentage price change over the last 252 trading days: Performance=(Closetoday​/Close252daysago​)−1. Require this value to be below a specific negative threshold (e.g., -0.20 for a 20% decline). 
     

    Combine Criteria: A robust definition might combine multiple checks. For instance, require both Performance < -20% AND Price < 200 SMA for the majority of the past year AND the 200 SMA slope to be negative over the period. 
     

The process of defining a "year-long downtrend" programmatically necessitates setting specific, objective thresholds. Whether using price relative to an MA, the MA's slope, or overall performance, parameters like the lookback period (252 days), the MA length (e.g., 200 days), the required duration below the MA, the minimum percentage decline, or the degree of slope negativity must be chosen.1 There is no single universal standard; the chosen parameters reflect the desired strictness of the filter and will influence which stocks qualify for the subsequent reversal analysis.
Establishing a prolonged downtrend, such as one year, provides crucial context for the subsequent reversal pattern sought by the user. A lengthy decline implies that significant selling pressure has occurred, potentially leading to seller exhaustion and capitulation. This sets the stage for a meaningful base-building phase (Weinstein's Stage 1) where ownership may transfer from discouraged sellers to value-oriented buyers.1 The user's specific pattern—a flattening and rising 150 SMA after a downtrend—targets precisely this transition from decline to potential recovery.12 A shorter preceding decline might merely represent a correction within a larger uptrend, making the subsequent MA behavior less indicative of a major trend reversal. 
3. Analyzing the 150-Day SMA Dynamics 

The core of the user's query revolves around the behavior of the 150-day Simple Moving Average (SMA): its initial flattening and subsequent upward turn. This section details the calculation, significance, and methods for detecting these specific dynamic changes. 
3.1. The 150-Day SMA 

     

    Calculation: The 150-day SMA is the arithmetic mean of the closing prices over the most recent 150 trading days.6 The formula is: SMA150​=150∑i=1150​Closei​​ As each new day's closing price becomes available, the oldest price is dropped, and the average is recalculated, causing the average to "move" over time.8 
     

    Significance: The 150-day SMA serves as a medium-to-long-term trend filter.19 It smooths out daily price fluctuations to reveal the underlying trend direction and momentum.6 Its significance is highlighted by its use in established technical analysis frameworks: 
         

        Stan Weinstein's Stage Analysis: The 30-week moving average, which corresponds closely to the 150-day SMA (30 weeks * 5 trading days/week = 150 days), is a cornerstone of this method for identifying market stages.12 
         

        Mark Minervini's Trend Template: This template uses the 150-day MA (along with the 50-day and 200-day MAs) to identify stocks in strong uptrends suitable for trading.21 
         
     

3.2. Detecting SMA Flattening (Transition Phase) 

     

    Concept: A flat or flattening moving average indicates a period of market consolidation, indecision, or a potential transition between trends.8 In the context of the user's query, following a year-long downtrend, the flattening of the 150 SMA signals the potential cessation of the decline (Stage 4) and the beginning of a base-building phase (Stage 1).12 During this phase, supply and demand reach equilibrium.12 
     

    Methods for Quantifying Slope: Several methods can quantify the slope of the 150 SMA to detect flattening: 
         

        Slope via Difference: Calculate the change in the SMA value over a defined lookback period (N days) and divide by N.24 SlopeDiff​=NSMA150,today​−SMA150,Ndaysago​​ A slope value close to zero suggests flatness. The choice of N (e.g., 5, 10, or 20 days) determines the sensitivity to recent changes in the MA's direction. 
         

        Slope via Linear Regression: Fit a linear regression line to the last N data points of the 150 SMA. The slope of this best-fit line provides a statistically smoother measure of the MA's rate of change.25 The formula for the slope (m) of a line y=mx+b fitted to N points (xi​,yi​) (where yi​ is the SMA value at time xi​) is: m=N∑(xi2​)−(∑xi​)2N∑(xi​yi​)−∑xi​∑yi​​ 25 Again, a slope value near zero indicates flatness. This method is generally less sensitive to single outliers in the MA values compared to the simple difference method. 
         

        Slope via Angle: Convert the calculated slope (from either difference or regression) into an angle, typically in degrees, using the arctangent function.30 Angle(degrees)=arctan(Slope)×π180​ 30 An angle close to 0 degrees represents a flat MA. This provides an intuitive interpretation of the MA's trajectory. 
         
     

    Normalization: Raw slope values (e.g., dollars per day) are difficult to compare across stocks with vastly different price levels or volatility. A $0.05 change per day might be significant for a $10 stock but negligible for a $500 stock. Normalization addresses this by scaling the slope relative to price or volatility.27 Common normalization techniques include: 
         

        Dividing the raw slope by the standard deviation of the slope over a lookback period (yielding slope in "sigma units").36 
         

        Dividing the raw slope by the current price or average price (yielding slope as a percentage change per bar).27 
         

        Dividing by the Average True Range (ATR) to account for volatility.37 Normalized slopes allow for consistent threshold setting across different securities. 
         
     

    Thresholding: A perfectly flat MA (slope exactly zero) is rare. Therefore, "flattening" is defined programmatically as the slope falling within a narrow band around zero.24 For example: 

    ∣NormalizedSlope∣<Thresholdflat​ 

    The specific value for Thresholdflat​ (e.g., 0.1 standard deviations, or +/- 1 degree) is crucial and typically determined through backtesting and optimization.24 Some advanced indicators employ adaptive thresholds that adjust based on recent market volatility, widening the "flat" zone in volatile markets and narrowing it in quiet ones.41 
     

    Table 1: Comparison of MA Slope Calculation Methods 
     

MethodCalculation ConceptProsConsKey ReferencesDifference(MAt​−MAt−n​)/nSimple, intuitiveSensitive to choice of 'n'24Linear RegressionSlope of best-fit line over N MA pointsStatistically robust, smootherMore complex calculation25Angle (Degrees)arctan(Slope)×180/πIntuitive interpretationAdds trigonometric step30 
 
 
 
1
*Justification for Table:* This table offers a concise summary of the primary quantitative methods for calculating the MA slope, essential for detecting the flattening and turning behavior central to the user's query. It highlights the trade-offs, aiding in the selection of an appropriate implementation method.
 
 
3.3. Detecting SMA Upward Turn (Confirmation of Reversal) 

     

    Concept: Following the flattening phase, the 150 SMA begins to slope upwards, indicating that the average price over the last 150 days is now increasing.6 This signifies a potential shift from consolidation (Stage 1) to a new uptrend (Stage 2).12 
     

    Implementation: Detecting the upward turn requires the calculated slope to become definitively positive: 
         

        Condition 1 (Positive Slope): The calculated slope (using methods from 3.2, preferably normalized) must exceed the defined "flat" threshold and be positive.24 NormalizedSlope>Thresholdrising​ Where Thresholdrising​ is typically equal to or slightly greater than Thresholdflat​. 
         

        Condition 2 (Optional - Increasing Slope / Acceleration): To confirm the MA is actively bending upwards, one can check if the slope itself is increasing. This involves comparing the current slope to the previous period's slope: Slopetoday​>Slopeyesterday​.38 Alternatively, calculate the second derivative (acceleration) of the 150 SMA.40 A positive acceleration value confirms the upward curvature. The MACD histogram is conceptually related to moving average acceleration, measuring the divergence between a fast and slow MA.55 
         
     

    Lookback Period (N for Slope): The choice of N impacts how quickly the turn is detected. A shorter N (e.g., 5-10 days) applied to the 150 SMA slope calculation will react faster to changes in the MA's direction but will be more susceptible to short-term fluctuations (noise). A longer N (e.g., 20-30 days) will provide a smoother slope reading but will confirm the turn later.24 
     

The detection process must recognize the sequence: the MA slope must first be near zero (flattening) before turning positive. An algorithm should verify that the |Normalized Slope| < Threshold_{flat} condition was met recently, prior to confirming the Normalized Slope > Threshold_{rising} condition. This ensures the pattern matches the user's specific request for a flattening followed by an upturn, characteristic of a Stage 1 to Stage 2 transition 12, rather than just any instance of a positive MA slope.
Furthermore, simply checking if the slope is greater than zero is often insufficient due to market noise. Minor positive fluctuations can occur even within a broader downtrend or consolidation. Using normalization and establishing a meaningful positive threshold (Thresholdrising​) is crucial for filtering out this noise and identifying a significant change in the MA's trajectory.36 Normalization ensures this threshold is comparable across stocks with different price scales and volatilities.36
It is vital to remember that the 150-day SMA is a lagging indicator.6 It averages prices over the past 150 trading days (approximately 7 months). Consequently, the detected "flattening" and "upward turn" will necessarily occur after the absolute price bottom has formed. The strategy does not aim to pinpoint the exact low but rather to confirm that a potential shift in the medium-to-long-term trend has gained enough traction to influence the average itself, increasing confidence in the reversal's sustainability.6 While using an Exponential Moving Average (EMA) could reduce this lag due to its weighting towards recent prices, it comes at the cost of potentially increased sensitivity to noise and false signals (whipsaws).6 
4. Confirming Price Strength Relative to SMA 

Beyond the behavior of the 150-day SMA itself, the user requires confirmation based on the stock's price position relative to this moving average. 
Requirement 

The closing price must remain above the 150-day SMA for a minimum of 5 consecutive trading days. 
Rationale 

This requirement serves as a crucial filter to confirm initial bullish strength following the potential bottom and MA turn. A simple price cross above a moving average is a common bullish signal, but it can often be temporary, resulting in a "whipsaw" where the price quickly falls back below.7 Requiring the price to stay above the 150 SMA for a full trading week (5 days) demonstrates a higher degree of buyer commitment and resilience against immediate selling pressure.9
This condition aligns conceptually with established trading principles: 

     

    Support/Resistance Transition: Moving averages often act as dynamic levels of support and resistance.8 During the preceding downtrend, the 150 SMA likely acted as a resistance level. Price breaking above this level and, more importantly, holding above it for a sustained period (like 5 days) suggests that demand is now sufficient to absorb selling pressure at that level. This indicates a potential shift where the former resistance is becoming new support, a hallmark of a trend change.17 
     

    Stage Analysis Confirmation: In Weinstein's Stage Analysis, entering Stage 2 requires the price to be trading above the rising 30-week (150-day) MA.12 Similarly, Minervini's template requires the price to be above key moving averages, including the 150-day MA, to confirm an uptrend.21 The 5-day duration adds a layer of confirmation beyond a single-day close above the MA. 
     

Programmatic Implementation 

This condition can be checked programmatically using daily closing prices and the calculated 150-day SMA values: 

     

    Identify Current Day: Let the current trading day be t. 
     

    Check Previous Days: Examine the closing prices and 150 SMA values for the days t,t−1,t−2,t−3,t−4. 
     

    Condition Check: For each day i from t−4 to t, verify if Closei​>SMA150,i​. 
     

    Confirmation: If the condition Closei​>SMA150,i​ holds true for all 5 consecutive days, the criterion is met. 
     

This can be implemented efficiently using loops or rolling window functions available in data analysis libraries like pandas in Python. For example, a rolling window of size 5 can be applied to a boolean series (Close > SMA150), checking if all values within the window are True.
It is logical for this price confirmation condition to be met after or concurrently with the 150 SMA beginning its upward turn. If the price manages to stay above the 150 SMA for 5 days while the average itself is still declining significantly, the overall signal is weaker and potentially contradictory. A more robust signal occurs when the price demonstrates strength (staying above the MA) as the MA itself confirms the shift in underlying trend by flattening and starting to rise.7 Minervini's criteria, for instance, explicitly require the price to be above rising moving averages, emphasizing this alignment.21 
5. Utilizing Confirmation Indicators 

While the combination of a preceding downtrend, specific 150 SMA behavior (flattening then rising), and price holding above the 150 SMA forms the core of the desired pattern, relying solely on these elements can be risky. Moving averages are lagging indicators, and their signals (slope changes, price crossovers) can generate false positives, known as whipsaws, particularly in non-trending or choppy market conditions.8 To enhance the reliability of the setup and filter out weaker signals, incorporating confirmation indicators is highly recommended.8 These indicators assess other market dimensions like momentum and volume, providing a more holistic view. 
5.1. Momentum Oscillators (RSI, MACD) 

Momentum oscillators measure the speed and change of price movements, often providing early warnings of potential trend exhaustion or reversal. 

     

    Bullish Divergence: This is a powerful reversal signal that occurs when the price makes a new low (or a lower low compared to a previous trough) during the downtrend or bottoming phase, but the oscillator (e.g., RSI or MACD) fails to make a corresponding new low, instead forming a higher low.8 This divergence indicates that the selling momentum is weakening despite the lower price, suggesting that the downward thrust is losing power and a reversal may be imminent.62 Identifying bullish divergence in the period leading up to the 150 SMA flattening can significantly strengthen the case for a potential bottom. 
     

    MACD Signals: 
         

        Zero Line Crossover: The MACD line crossing above the zero line signals that the shorter-term EMA (typically 12-period) has crossed above the longer-term EMA (typically 26-period), indicating that short-term momentum has turned positive relative to the medium-term trend.55 This often occurs as a new uptrend begins. 
         

        Signal Line Crossover: The MACD line crossing above its signal line (typically a 9-period EMA of the MACD line) is an earlier, though less definitive, bullish momentum signal.55 
         
     

    RSI Signals: 
         

        Oversold Levels: The Relative Strength Index (RSI) moving upwards from oversold territory (typically below 30) indicates that buying pressure is starting to overcome recent selling pressure.8 
         

        Trend Confirmation: In a confirmed uptrend, the RSI tends to stay above the 40 level and often fluctuates between 50 and 80.66 Seeing the RSI climb decisively above 50 can help confirm the nascent uptrend suggested by the MA behavior. 
         
     

    Implementation: Calculate standard RSI(14) and MACD(12, 26, 9). Scan for bullish divergence between price and the chosen oscillator during the final stages of the downtrend, just before or during the 150 SMA flattening. Check for confirming signals like RSI rising above 30 or 50, or MACD crossing its signal line or the zero line, occurring concurrently with the primary MA slope and price criteria being met. 
     

5.2. Volume Analysis 

Volume reflects the level of participation and conviction behind price moves. Analyzing volume patterns can provide crucial confirmation for trend reversals. 

     

    Volume Spikes on Breakout: A significant increase in trading volume (e.g., 1.5x to 3x the average daily volume) as the price breaks above a key resistance level (which could be the 150 SMA itself or the high of the basing pattern) strongly validates the breakout.9 High volume suggests strong buying interest, potentially including institutional accumulation, increasing the likelihood that the new upward move will be sustained.21 Conversely, a breakout on low volume is suspect and more likely to fail.63 
     

    Price-Volume Divergence during Basing: As the stock forms its base (while the 150 SMA flattens), look for signs of accumulation. This might manifest as volume drying up on price declines (indicating lack of selling pressure) and increasing on price rallies within the base.66 This bullish divergence suggests buyers are quietly absorbing shares. 
     

    On-Balance Volume (OBV): OBV is a cumulative indicator that adds volume on up days and subtracts volume on down days.64 A rising OBV trend during the price basing period, especially if OBV starts making higher lows even while the price is still making lower lows (bullish divergence), is a strong sign of accumulation and often precedes a price breakout.16 A break above a downtrend line drawn on the OBV chart itself can also be a leading indicator.66 
     

    Implementation: Calculate a moving average of volume (e.g., 50-day average volume). Monitor daily volume relative to this average. Look for days where volume significantly exceeds the average, particularly on days where the price breaks above the 150 SMA or key resistance. Track the OBV indicator and look for an uptrend or bullish divergence against price during the basing period. 
     

5.3. Chart Patterns 

Specific chart patterns often form during market bottoms and can visually confirm the reversal process. 

     

    Double Bottom (W-Pattern): This common reversal pattern forms after a downtrend and consists of two distinct troughs at approximately the same price level, separated by an intermediate rally (peak).62 The pattern resembles the letter 'W'. It signifies that selling pressure failed to push the price to new lows on the second attempt, indicating strong support. The pattern is confirmed when the price breaks decisively above the resistance level formed by the intermediate peak.71 The user's criteria (150 SMA flattening/turning, price > 150 SMA) might coincide with the formation of the second bottom or the subsequent breakout above the W's midpoint. 
     

    Consolidation/Base Formation (Stage 1 Base): The period where the 150 SMA flattens is often characterized by sideways price movement within a defined range, known as a base or consolidation area.12 This represents the equilibrium between buyers and sellers (Stage 1). The subsequent breakout above the upper boundary (resistance) of this base, ideally on high volume, signals the potential start of the new uptrend (Stage 2) and aligns perfectly with the user's criteria. 
     

    Implementation: Automating complex pattern recognition can be challenging. However, simpler approximations can be used. For instance, identify periods where the price range (High - Low) or volatility (e.g., using ATR) contracts significantly while the 150 SMA slope is near zero. A subsequent breakout above the high of this consolidation range, confirmed by volume and the MA turning up, could trigger a signal. 
     

The most reliable trading signals arise from the convergence of multiple confirmation indicators with the primary MA and price criteria. For instance, a setup where the 150 SMA flattens and starts to rise, the price holds above it for 5+ days, and this occurs alongside bullish RSI divergence during the preceding low, followed by a high-volume breakout from a clear double bottom pattern, carries a much higher probability of success than relying on the MA criteria alone.8 Each indicator provides a different piece of the puzzle (trend, momentum, volume, pattern psychology), and their agreement builds a stronger "weight of evidence" supporting the reversal hypothesis.20
It's also noteworthy that some confirmation indicators, particularly momentum divergences and volume-based accumulation patterns, can act as leading indicators.16 Oscillators like RSI and MACD measure the rate of price change, which often decelerates before the price itself reverses direction.62 Similarly, shifts in volume dynamics (e.g., selling drying up, accumulation starting) can occur before the price trend definitively turns.66 While the user's criteria focus on the confirmation provided by the lagging 150 SMA, monitoring these potentially leading signals can help identify candidates that are likely to meet the full set of criteria in the near future. 

     Table 2: Confirmation Indicators for MA Reversal
     

Indicator/PatternTypeBullish Reversal SignalImplementation NotesKey ReferencesRSIMomentumBullish Divergence (Higher Lows); Rising from <30; Cross > 50Check divergence prior to MA turn; Check RSI level8MACDMomentumBullish Divergence; Crossover Signal Line; Crossover Zero LineCheck divergence prior to MA turn; Check crossovers8VolumeVolumeSpike on Breakout (> Avg); ↑Vol on Rallies / ↓Vol on DeclinesCompare daily vol to avg vol; Analyze vol during base9OBVVolume/MomentumRising OBV / Bullish Divergence; Break of OBV DowntrendTrack OBV trend relative to price trend16Double Bottom (W)Chart PatternPrice breaks above midpoint resistance after two ≈equal lowsHarder to automate; identify support holds & breakout62Base/ConsolidationChart PatternPrice breaks above range high after sideways move & flat MAIdentify range/volatility contraction, then breakout12 
 
 
 
1
*Justification for Table:* This table provides a structured overview of complementary indicators discussed in the research, summarizing their specific signals relevant to confirming the user's bottoming pattern. This aids in selecting appropriate confirmation tools for enhancing the algorithm's robustness.
 
 
6. Integrated Algorithms and Strategies 

The user's criteria describe a specific technical setup. Several existing, named trading strategies and frameworks incorporate similar logic, providing established contexts for this pattern. 
6.1. Stan Weinstein's Stage Analysis 

     

    Concept: Developed by Stan Weinstein and detailed in his 1988 book "Secrets for Profiting in Bull and Bear Markets," Stage Analysis categorizes a stock's price cycle into four distinct stages based primarily on its price action relative to a long-term moving average (originally the 30-week/150-day SMA, though sometimes the 40-week/200-day SMA is now used) and volume patterns.12 The stages are: 
         

        Stage 1: Basing Area (Accumulation) 
         

        Stage 2: Advancing Phase (Uptrend) 
         

        Stage 3: Topping Area (Distribution) 
         

        Stage 4: Declining Phase (Downtrend) 
         
     

    Relevance: The sequence described by the user aligns precisely with the transition from late Stage 4, through Stage 1, and into early Stage 2. 
         

        Stage 4 (Downtrend): Price trades below a declining 30-week/150-day MA.13 This matches the user's "preceding downtrend" requirement. 
         

        Stage 1 (Base): The downtrend loses momentum, and the price begins to move sideways, often "whipping" above and below the now flattening 30-week/150-day MA.12 This corresponds to the user's "150 SMA flattening" criterion. This stage represents a period of equilibrium where accumulation may occur.12 
         

        Stage 2 (Advance): The stock breaks out above the resistance level of the Stage 1 base, ideally on high volume, and begins to trend above a rising 30-week/150-day MA.12 This matches the user's "150 SMA turning upwards" and "price > 150 SMA" criteria. Weinstein also notes the importance of the price staying above the shorter-term 50-day MA during Stage 2.12 
         
     

    Confirmation: Weinstein heavily emphasizes the importance of volume confirmation on the breakout from Stage 1 to Stage 2 (volume should be significantly above average).12 He also incorporates Relative Strength analysis, preferring stocks that show improving relative strength versus the overall market during the Stage 1 base.73 
     

    Implementation: Implementing Stage Analysis requires calculating the 150-day SMA (or 200-day), determining its slope (visually or quantitatively), tracking price relative to the MA, and analyzing volume. Several platforms and tools offer dedicated Stage Analysis indicators or screeners, sometimes developed in consultation with Weinstein himself.13 
     

6.2. Moving Average Slope (MAS) Strategies 

     

    Concept: These strategies directly utilize the calculated slope (or angle) of one or more moving averages to generate trading signals or filter trades.24 The slope quantifies the momentum of the moving average itself.24 
     

    Relevance: This approach directly addresses the user's need to quantitatively define and detect when the 150 SMA is "flattening" and when it is "turning up." 
     

    Criteria Match: 
         

        Flattening: Defined as the MA slope falling within a predefined threshold range around zero (e.g., using normalized slope).24 
         

        Turning Up: Defined as the MA slope crossing above the upper boundary of the "flat" threshold and becoming definitively positive.24 
         
     

    Implementation: This requires calculating the 150 SMA slope using one of the methods described in Section 3.2 (Difference, Linear Regression, Angle). Normalization is highly recommended for setting consistent thresholds.36 Threshold values for "flat" and "rising" must be determined, typically through backtesting.24 The MAS logic would be combined with the preceding downtrend filter and the price > 150 SMA duration check. Several public TradingView scripts implement MA slope concepts (e.g., "Simple Moving Average Slope (SMAS)" 36, "EMA Slope" 40, "Slope Adaptive Moving Average" 44, "Slope Degree Moving Average" 78). 
     

6.3. Screener Logic Synthesis 

     

    Concept: Stock screeners allow users to filter the entire market based on a combination of technical and/or fundamental criteria to identify stocks meeting specific conditions.8 
     

    Relevance: A screener provides a practical framework for implementing the user's multi-component request. 
     

    Criteria Implementation in a Screener: A hypothetical screener setup to capture the user's pattern might include filters like: 
         

        Downtrend Filter: 
             

            Performance (1 Year) < -20% 11 
             

            And/Or Price below 200 SMA 11 (Potentially checked over a period, if possible) 
             
         

        MA Behavior Filter: 
             150 SMA Slope is Positive / Rising 22 (This captures the "turning up" phase. Detecting the prior "flattening" might require custom scripting or post-analysis).
             
         

        Price Confirmation Filter: 
             

            Price above 150 SMA 22 
             

            (Advanced/Custom) Check if Price has been above 150 SMA for the last 5 days. Standard screeners often struggle with duration-based conditions like this; it might need to be verified manually or via a custom script after initial screening. 
             
         

        Optional Confirmation Filters: 
             

            Volume > Average Volume (50 day) x 1.5 11 
             

            RSI (14) > 30 11 
             

            MACD Line (12,26,9) above MACD Signal (12,26,9) 11 
             
         
     

    Platforms: Many platforms offer screening capabilities, including Finviz 11, StockCharts 67, TradingView 68, ChartMill 22, Deepvue 13, Market Chameleon 87, VectorVest 88, Zacks 85, Stock Rover 85, TC2000.85 The ability to screen specifically for MA slope turning from flat to positive, and for price staying above an MA for a duration, varies significantly by platform and may require premium features or custom programming capabilities. 
     

Among these integrated approaches, Stan Weinstein's Stage Analysis provides the most direct and well-documented conceptual framework that aligns with the user's desired pattern. The transition from Stage 1 (base, flat MA) to Stage 2 (advance, rising MA) using the 150-day SMA precisely captures the sequence of events specified: downtrend -> MA flattening -> MA turning up -> price confirmation above the MA.12 Adopting this framework offers a structured approach with additional context provided by Weinstein's emphasis on volume and relative strength.12
However, while Stage Analysis offers a strong conceptual fit, its traditional application can sometimes involve subjective visual interpretation of the MA slope.12 Implementing a dedicated MA Slope strategy allows for a more purely quantitative approach. By explicitly calculating the (normalized) slope and defining numerical thresholds for "flat" and "rising," this method offers potentially more precise, objective, and granular control over signal generation.24 This precision might be particularly advantageous for algorithmic implementation, allowing fine-tuning of the sensitivity to the MA's rate of change, potentially enabling earlier signal detection compared to purely visual or simpler rule-based stage identification. 

     Table 3: Comparison of Integrated Strategies
     

StrategyCore ConceptKey Criteria MatchConfirmationProsConsKey ReferencesStage Analysis (Weinstein)4-stage stock cycle based on Price & 30w/40w MAExcellent match for Stage 1->2 transitionVolume, Relative StrengthWell-documented, holistic frameworkCan be subjective, MA period varies12MA Slope StrategySignals based on MA slope value & directionDirect match for MA flattening/turning upOften combined w/ othersQuantitative, precise control via thresholdsRequires careful threshold tuning, can be noisy24Custom ScreenerFilter stocks based on combined technical criteriaCan implement all criteria (if platform allows)User-defined (Vol, Mom.)Flexible, tailored to exact needsRequires capable platform/code, duration checks difficult21 
 
 
 
1
*Justification for Table:* This table directly addresses the user's request to identify existing algorithms by comparing the most relevant integrated approaches found in the research. It highlights how each strategy aligns with the specific query components (MA behavior, price confirmation) and outlines their strengths and weaknesses for implementation.
 
 
7. Implementation Considerations 

Successfully implementing an algorithm based on the described criteria requires careful consideration of several practical factors, including indicator choices, parameter tuning, handling inherent limitations, and selecting appropriate tools. 
7.1. Choosing MA Type (SMA vs. EMA) 

The user explicitly requested the 150-day Simple Moving Average (SMA). 

     

    SMA (Simple Moving Average): Calculates an unweighted average of the last 150 closing prices. It provides a smoother representation of the trend but reacts more slowly to recent price changes due to the equal weighting of all data points in the period.6 This lag means trend change signals (like the upward turn) will appear later compared to an EMA. However, it represents the "true" average price over the 150 days 18 and may be less prone to generating false signals (whipsaws) in choppy markets. 
     

    EMA (Exponential Moving Average): Assigns greater weight to more recent closing prices, making it more responsive to new price information and reducing lag compared to the SMA.6 An EMA(150) would likely detect the flattening and upward turn slightly earlier than an SMA(150). The trade-off is increased sensitivity, which can lead to more false signals, especially during periods of consolidation or volatility. 
     

Recommendation: Begin implementation using the SMA(150) as specified. During the backtesting and optimization phase, consider comparing its performance against an EMA(150) to empirically evaluate the trade-off between lag and signal noise for the specific assets and timeframes being analyzed.18 
7.2. Parameter Tuning 

Several parameters require careful tuning, ideally through rigorous backtesting: 

     

    Slope Lookback Period (N): This determines how many recent SMA data points are used to calculate the slope (e.g., in the difference method (SMAt​−SMAt−N​)/N or as the period for linear regression). A shorter N (e.g., 5-10 days) makes the slope calculation more sensitive to recent changes in the 150 SMA's direction, allowing for earlier detection of flattening or turning. A longer N (e.g., 20-30 days) results in a smoother slope calculation, filtering out more noise but increasing lag.24 There's no single "best" value; it requires optimization.24 
     

    Slope Thresholds: Defining the numerical boundaries for "flat" and "rising" is critical and highly sensitive.24 These thresholds depend heavily on the chosen slope calculation method, the normalization technique (if any), the asset's typical volatility, and the timeframe. Values suggested by existing indicators (like the 0.6 sigma default in SMAS 36) can serve as starting points, but extensive backtesting across diverse market conditions (trending, ranging, volatile) is essential to find robust values.24 Adaptive thresholds, while more complex, might offer better performance across varying volatility regimes.41 
     

    Confirmation Indicator Parameters: While standard settings like RSI(14) and MACD(12, 26, 9) are common starting points 66, their optimal values can also vary depending on the asset and strategy goals. The lookback period for average volume calculation (e.g., 50 days) also needs to be defined. 
     

7.3. Addressing Lag and Whipsaws 

These are inherent challenges when using moving average-based strategies. 

     

    Lag: Moving averages, especially long-term ones like the 150-day SMA, are lagging indicators by nature.6 The signal confirming the trend turn will always occur after the actual price bottom. This must be accepted; the strategy aims to capture the confirmed start of a new trend, not the absolute turning point. Using EMAs or shorter slope lookback periods can mitigate lag but increases sensitivity to noise.18 
     

    Whipsaws: False signals generated during sideways, non-trending, or volatile markets are a common problem.8 Strategies to mitigate whipsaws include: 
         

        Confirmation: Requiring agreement from other indicators (Volume, RSI, MACD divergence) before acting on the MA signal (as discussed in Section 5).8 
         

        Stricter Thresholds: Using more demanding slope thresholds for defining "rising" can filter out weaker, potentially false, upturns.42 
         

        Trend Filters: Adding an independent trend filter, like requiring the Average Directional Index (ADX) to be above a certain level (e.g., 20 or 25) to indicate a trending environment before accepting MA slope signals.11 
         

        Regime Filters: Implementing logic to detect choppy or range-bound markets (e.g., by measuring the compression between multiple moving averages 80, using volatility bands like Bollinger Bands 6, or checking if ATR is below a certain threshold) and temporarily disabling trading signals during such periods.80 
         
     

7.4. Potential Python Libraries/Functions 

For users implementing this algorithm in Python, several libraries are well-suited: 

     

    Data Manipulation: pandas is the standard for handling time-series data like OHLCV. 
     

    MA Calculation: 
         

        pandas: df['Close'].rolling(window=150).mean() calculates the SMA.30 
         

        pandas-ta: A popular library offering a wide range of technical indicators, including various MAs (df.ta.sma(length=150)), RSI, MACD, OBV, ATR, etc..97 
         
     

    Slope Calculation: 
         

        Difference Method: Can be calculated using pandas .diff() method: sma150 = df.ta.sma(150); slope = sma150.diff(N) / N.30 
         

        Linear Regression: numpy.polyfit(x, y, 1) (where y is the last N SMA values and x is range(N)) or scipy.stats.linregress(x, y).slope. pandas-ta might also offer slope or regression functions (df.ta.linreg, df.ta.slope).25 
         

        Angle: numpy.arctan() and numpy.degrees() applied to the calculated slope.30 
         
     

    Rolling Condition Check: pandas.DataFrame.rolling(window=5).apply(lambda x: x.all(), raw=True) can be used on a boolean series (df['Close'] > df) to check the 5-day condition. 
     

    Backtesting: Libraries like Backtrader, VectorBT, or custom scripts are needed for simulating the strategy on historical data. 
     

    GitHub Resources: Searching GitHub repositories related to algorithmic trading, technical analysis, pandas-ta, or specific strategies like Stage Analysis might yield relevant code examples, though finding an exact match for the MA slope logic combined with all criteria might require adaptation.30 
     

The implementation process inherently involves navigating trade-offs. The choice of MA type and slope calculation period affects the balance between lag and noise.18 Setting thresholds involves balancing sensitivity (catching turns early) against reliability (avoiding false signals).24 Optimization through backtesting is not a one-time fix but an ongoing process, as optimal parameters may shift with changing market dynamics and volatility regimes.90
While the core concept requested by the user—identifying a bottoming pattern based on MA slope reversal—appears relatively straightforward, translating it into a robust and reliable trading algorithm is a non-trivial task. It demands careful attention to the details of slope calculation, normalization methods, precise threshold setting, handling the duration requirement for price confirmation, and integrating supplementary indicators to filter signals effectively. This moves significantly beyond simple moving average crossover systems and requires a systematic, quantitative approach.94 
8. Conclusion and Recommendations 
Summary of Findings 

This report has explored quantitative methods and existing algorithms to identify stocks meeting specific bottoming criteria: a preceding year-long downtrend, followed by the 150-day SMA flattening and turning upwards, with the price confirming strength by holding above the 150 SMA for at least five consecutive days. Key findings include: 

     

    Downtrend Quantification: Can be defined using price relative to the 200-day SMA, negative performance over ~252 days, or Stage Analysis (Stage 4). Implementation requires specific thresholds. 
     

    150 SMA Flattening & Turning Up: Best quantified using the slope of the 150 SMA. Calculation methods include difference-based, linear regression, or angle conversion. Normalization (e.g., via standard deviation or price) is crucial for setting meaningful thresholds to define "flat" (near zero slope) and "rising" (positive slope exceeding threshold). The sequence (flattening then rising) is important. 
     

    Price Confirmation: Programmatically verified by checking if the closing price has remained above the 150 SMA for the last 5 (or more) consecutive trading days using rolling window logic. 
     

    Confirmation Indicators: Momentum oscillators (RSI, MACD) for identifying bullish divergence and momentum shifts, and volume analysis (volume spikes on breakouts, OBV trends) are essential for filtering MA signals and reducing whipsaws. 
     

Recommended Algorithms/Strategies 

Based on the analysis, two primary approaches are recommended for implementing the user's desired strategy: 

     

    Primary Recommendation: Stan Weinstein's Stage Analysis (Stage 1 -> Stage 2 Transition): 
         

        This framework provides the closest conceptual match to the user's criteria. The transition involves the 150-day (30-week) SMA flattening (Stage 1 base) and then turning up as price breaks out above it (Stage 2 advance) following a Stage 4 decline.12 
         

        Implementation: Use the 150-day SMA. Quantify the "flattening" and "rising" phases using a robust slope calculation method (e.g., Linear Regression slope normalized by standard deviation) with backtested thresholds. Combine with the 1-year downtrend filter, the 5-day price > 150 SMA check, and Weinstein's emphasis on volume confirmation during the breakout and potentially relative strength analysis.12 
         
     

    Alternative: Dedicated Normalized MA Slope Strategy: 
         

        This offers more direct quantitative control over the slope dynamics. 
         

        Implementation: Calculate the normalized slope of the 150-day SMA (e.g., using standard deviation scaling 36). Define specific numerical thresholds for "flat" (e.g., ∣NormalizedSlope∣<0.1) and "rising" (e.g., NormalizedSlope>0.2). Trigger signals based on the transition from flat to rising. Integrate this core slope logic with the 1-year downtrend filter, the 5-day price > 150 SMA confirmation, and confirmation from volume or momentum indicators. 
         
     

Essential Steps for Implementation 

Regardless of the chosen framework, successful implementation requires: 

     

    Precise Quantification: Define all criteria with specific, objective parameters (lookback periods for downtrend and slope, MA lengths, thresholds for slope/performance/confirmation indicators). 
     

    Integration of Confirmation: Mandate confirmation from volume analysis (e.g., breakout volume > 1.5x average) and/or momentum indicators (e.g., absence of bearish divergence, RSI > 50) to filter signals and improve robustness.8 
     

    Rigorous Backtesting: Test the complete algorithm across diverse historical market periods (bull, bear, sideways markets) to optimize parameters (especially slope lookback and thresholds), evaluate performance metrics (CAGR, Sharpe ratio, max drawdown), and assess robustness.24 Sensitivity analysis on parameters is recommended.90 
     

    Appropriate Tools: Utilize suitable programming languages and libraries (e.g., Python with pandas, numpy, pandas-ta, and a backtesting engine) for development and testing.30 
     

Final Caution 

It must be emphasized that technical analysis strategies, including those based on moving averages and their slopes, do not guarantee future profits. Market conditions change, and past performance is not necessarily indicative of future results.56 The inherent lag in moving averages and the potential for whipsaws remain challenges. Therefore, any implementation should incorporate robust risk management principles, including the use of stop-loss orders and appropriate position sizing, tailored to the individual's risk tolerance and capital.8 